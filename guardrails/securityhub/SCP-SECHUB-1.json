{
    "Identifier": "SCP-SECHUB-1",
    "Guardrail": "Prevent leaving centralization of SecurityHub accounts",
    "Rationale": [
        "When SecurityHub is enabled and consolidated within for the AWS Organization, the member accounts should not leave the organization"
    ], 
    "Test Scenarios": [
        {
            "Test-Scenario": "Disable Security Hub from member account",
            "Steps": [
                "Log in to the AWS console with a role that has access to SecurityHub in member account", 
                "Goto Settings>General , scroll to the bottom of the page and click Disable AWS Security Hub"
            ],
            "Expected-Result": "Access Denied"
        },
        {
            "Test-Scenario": "Dissociate Security Hub from SecurityHub administrator account",
            "Steps": [
                "Log in to the AWS console with a role that has access to SecurityHub in member account", 
                "Goto Settings>Accounts , toggle the radio button to dissociate from Security Hub administrator account"
            ],
            "Expected-Result": "Access Denied"
        }
    ],
    "References": [
        "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-disable.html",
        "https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-data-retention.html",
        "https://docs.aws.amazon.com/securityhub/latest/userguide/accounts-orgs-disassociate.html"
    ],
    "Policy-Type": "SCP",
    "SCP-Type": "Prevent-All", 
    "IAM Actions": ["securityhub:DisableSecurityHub", 
        "securityhub:DissociatefromMasterAccount" ],
    "Resource": ["*"]
}