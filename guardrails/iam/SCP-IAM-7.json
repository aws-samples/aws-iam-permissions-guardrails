{
    "Identifier": "SCP-IAM-7",
    "Guardrail": "Prevent Users from Deleting AWS Access Analyzer in an Account",
    "Rationale": [
        "Access Analyzer is often used to detect anomalous user behavior, a user deleting this may be trying to conceal their activities."
    ], 
    "Test Scenarios": [
        {
            "Test-Scenario": "Create new user",
            "Steps": [
                "Log in to the AWS console with a role that is allowed to delete access analyzer", 
                "Delete access analyzer"
            ],
            "Expected-Result": "Access Denied"
        }
    ],
    "References": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"
    ],
    "Policy-Type": "SCP",
    "SCP-Type": "Prevent-All",
    "IAM Actions": [
        "access-analyzer:DeleteAnalyzer"
    ],
    "Resource": ["*"]
}