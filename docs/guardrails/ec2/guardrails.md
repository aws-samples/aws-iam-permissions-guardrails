---
layout: default
---

## Amazon Elastic Compute Cloud (EC2)

| Identifier   | Guardrail                                                                                                                        | Rationale                                                                                                                                                                                                                                                                                                                                                                                                                             | Remediation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | References                                                                                                                                                                                                                                                                           | Policy   | IAM Actions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|:-------------|:---------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| IAM-EC2-1    | Check that the ability to terminate EC2 instances are appropriately scoped or are only assumable to authorized principals.       | In Production or Production-like environments,no one other than IaC tools should have access to delete resources. Even in development, unintentional termination of EC2 instances can delay project timelines or delivery. If ec2:TerminateInstances has a wildcard resource policy ( Resource *) that isnâ€™t scoped with a condition statement such as ec2:ResourceTag, unauthorized EC2 instances might be inadvertently terminated. | For unauthorized principals, either remove ec2:TerminateInstances or appropriately scope with Condition keys. Remove ec2:TerminateIntances for unauthorized principals.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | nan                                                                                                                                                                                                                                                                                  | IAM      | ec2:TerminateInstances                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| IAM-EC2-2    | Check EC2 instances can only run instances with approved Amazon Machine Images (AMIs).                                           | For security hardening, vulnerability management, and configuration management purposes, only approved AMIs should be used to launch instances in Production or Production-like environments.                                                                                                                                                                                                                                         | Scope ec2:RunInstances resources to approved AMI ids or Use Condition tag with ec2:ResourceTag                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | https://aws.amazon.com/premiumsupport/knowledge-center/restrict-launch-tagged-ami/ https://aws.amazon.com/blogs/aws/amazon-ec2-resource-level-permissions-for-runinstances/ https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonec2.html#amazonec2-ec2_ResourceTag___TagKey_ | IAM      | ec2:RunInstances                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| IAM-EC2-3    | Check that all network modification permissions are granted to authorized roles only, ideally the AWS Account provisioning role. | For all environments it is important to maintain and manage authorized network permitters and boundaries. Unauthorized network modifications could expose the network or service to attacks or data exfiltration. These actions are commonly associated with account provisioning rather than daily or frequent usage.                                                                                                                | Scope the following Actions only to the AWS Account provisioning role. AssociateDhcpOptions AssociateRouteTable AssociateSubnetCidrBlock AssociateVpcCidrBlock AttachInternetGateway AttachVpnGateway CreateCustomerGateway CreateDhcpOptions CreateInstanceExportTask CreateInternetGateway CreateRoute CreateRouteTable CreateSubnet CreateVpc CreateVpcEndpoint CreateVpcEndpointServiceConfiguration CreateVpcPeeringConnection CreateVpnConnection CreateVpnConnectionRoute CreateVpnGateway DeleteCustomerGateway DeleteDhcpOptions DeleteEgressOnlyInternetGateway DeleteInternetGateway DeleteNatGateway DeleteNetworkAcl DeleteNetworkAclEntry DeleteRoute DeleteRouteTable DeleteSubnet DeleteVpc DeleteVpcEndpointServiceConfigurations DeleteVpcEndpoints DeleteVpcPeeringConnection DeleteVpnConnection DeleteVpnConnectionRoute DeleteVpnGateway DetachInternetGateway DetachVpnGateway DisableVgwRoutePropagation DisassociateRouteTable DisassociateSubnetCidrBlock DisassociateVpcCidrBlock EnableVgwRoutePropagation ModifySubnetAttribute ModifyVpcAttribute ModifyVpcEndpoint ModifyVpcEndpointServiceConfiguration ModifyVpcEndpointServicePermissions ModifyVpcPeeringConnectionOptionsconnection ReplaceRoute ReplaceRouteTableAssociation | https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_Operations.html                                                                                                                                                                                                           | IAM      | ['ec2:AssociateDhcpOptions', 'ec2:AssociateRouteTable', 'ec2:AssociateSubnetCidrBlock', 'ec2:AssociateVpcCidrBlock', 'ec2:AttachInternetGateway', 'ec2:AttachVpnGateway', 'ec2:CreateCustomerGateway', 'ec2:CreateDhcpOptions', 'ec2:CreateInstanceExportTask', 'ec2:CreateInternetGateway', 'ec2:CreateRoute', 'ec2:CreateRouteTable', 'ec2:CreateSubnet', 'ec2:CreateVpc', 'ec2:CreateVpcEndpoint', 'ec2:CreateVpcEndpointServiceConfiguration', 'ec2:CreateVpcPeeringConnection', 'ec2:CreateVpnConnection', 'ec2:CreateVpnConnectionRoute', 'ec2:CreateVpnGateway', 'ec2:DeleteCustomerGateway', 'ec2:DeleteDhcpOptions', 'ec2:DeleteEgressOnlyInternetGateway', 'ec2:DeleteInternetGateway', 'ec2:DeleteNatGateway', 'ec2:DeleteNetworkAcl', 'ec2:DeleteNetworkAclEntry', 'ec2:DeleteRoute', 'ec2:DeleteRouteTable', 'ec2:DeleteSubnet', 'ec2:DeleteVpc', 'ec2:DeleteVpcEndpointServiceConfigurations', 'ec2:DeleteVpcEndpoints', 'ec2:DeleteVpcPeeringConnection', 'ec2:DeleteVpnConnection', 'ec2:DeleteVpnConnectionRoute', 'ec2:DeleteVpnGateway', 'ec2:DetachInternetGateway', 'ec2:DetachVpnGateway', 'ec2:DisableVgwRoutePropagation', 'ec2:DisassociateRouteTable', 'ec2:DisassociateSubnetCidrBlock', 'ec2:DisassociateVpcCidrBlock', 'ec2:EnableVgwRoutePropagation', 'ec2:ModifySubnetAttribute', 'ec2:ModifyVpcAttribute', 'ec2:ModifyVpcEndpoint', 'ec2:ModifyVpcEndpointServiceConfiguration', 'ec2:ModifyVpcEndpointServicePermissions', 'ec2:ModifyVpcPeeringConnectionOptionsconnection', 'ec2:ReplaceRoute', 'ec2:ReplaceRouteTableAssociation'] |
| IAM-EC2-4    | Check that sensitive more frequently used EC2 actions are appropriately scoped to approprariate roles and resources.             | These EC2 actions might be more frequently needed, particularly in a development environment. However, these are sensitive EC2 permissions and should be appropriately scoped and for authorized roles only.                                                                                                                                                                                                                          | Secure using IAM condition statements and tags.InstanceSecurityGroup AttachVolume CopyImage CopyFpgaImage CreateFpgaImage CreateImage DeleteFpgaImage DeregisterImage DisassociateAddress DisassociateIamInstanceProfile ModifyFpgaImageAttribute ModifyImageAttribute ReplaceIamInstanceProfileAssociation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonec2.html#amazonec2-policy-keys https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_Operations.html                                                                                                                |          | ['ec2:InstanceSecurityGroup', 'ec2:AttachVolume', 'ec2:CopyImage', 'ec2:CopyFpgaImage', 'ec2:CreateFpgaImage', 'ec2:CreateImage', 'ec2:DeleteFpgaImage', 'ec2:DeregisterImage', 'ec2:DisassociateAddress', 'ec2:DisassociateIamInstanceProfile', 'ec2:ModifyFpgaImageAttribute', 'ec2:ModifyImageAttribute', 'ec2:ReplaceIamInstanceProfileAssociation']                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |